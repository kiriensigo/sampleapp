# BGR v2 統合要件定義書

## 📋 ドキュメント統合について

このドキュメントは以下の要件定義を統合したものです：
- ルート: `BGR_V2_要件定義書.md` （初期要件定義）
- bgr-v2: `review-requirements.md` （レビューシステム詳細要件v2）

---

## 🎯 プロジェクト概要

### 基本情報
- **プロジェクト名**: BGR (Board Game Review) Version 2
- **根本的な目的**: **短時間でレビューができる**ボードゲームレビューサイト
- **ターゲット**: ボードゲーム愛好家、レビュアー、ゲーム情報を求めるユーザー
- **現在のサイト**: https://bgrq.netlify.app/

### 技術スタック

#### フロントエンド
- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **UI コンポーネント**: shadcn/ui + Radix UI

#### バックエンド・データベース
- **データベース**: Supabase (PostgreSQL)
- **認証**: Supabase Auth (Google, Twitter OAuth)
- **API**: Netlify Functions + BGG API連携

#### デプロイメント
- **ホスティング**: Netlify
- **ドメイン**: デフォルトNetlifyドメイン使用

---

## 📋 詳細ユースケース

### UC-001: 簡単レビュー投稿 ⭐
**アクター**: 登録ユーザー  
**目的**: 5つの要素をスライダーで簡単にレビューする

**基本フロー**:
1. ユーザーがゲーム詳細ページでレビューボタンをクリック
2. 5つのスライダーで評価を入力
   - 総合得点 (5-10、デフォルト7.5)
   - ルールの複雑さ (1-5)
   - 運要素 (1-5) 
   - インタラクション (1-5)
   - ダウンタイム (1-5)
3. おすすめプレイ人数をボタン選択
4. タグをボタン選択
5. カテゴリーをボタン選択
6. 150字以内のコメント入力（任意）
7. 投稿ボタンクリック
8. レビュー完了

**所要時間**: 1-2分

### UC-002: Twitterシェア
**アクター**: レビュー投稿者  
**目的**: 自分のレビューをTwitterで共有する

**基本フロー**:
1. レビュー投稿完了後、Twitter投稿ボタンを表示
2. ボタンクリックでTwitter投稿画面を開く
3. レビュー内容が自動でツイート文に挿入される

### UC-003: 詳細検索
**アクター**: 全ユーザー（未登録含む）  
**目的**: 自分の好みに合うゲームを発見する

**基本フロー**:
1. 検索ページにアクセス
2. 検索条件を指定:
   - プレイ人数
   - プレイ時間
   - 好きなタグ
   - 各要素の得点範囲（総合得点、複雑さ、運要素、インタラクション、ダウンタイム）
3. 検索実行
4. 条件に合うゲーム一覧を表示
5. 気になるゲームの詳細を確認

---

## 📝 機能要件

### FR-001: レビュー投稿機能 ⭐
- **必須項目**:
  - 総合得点 (5-10スライダー) ※7.5を普通のゲームとする
  - ルールの複雑さ (1-5スライダー)
  - 運要素 (1-5スライダー)
  - インタラクション (1-5スライダー)
  - ダウンタイム (1-5スライダー)
  - おすすめプレイ人数（複数選択可）
  - タグ（複数選択可）
  - カテゴリー（複数選択可）

- **任意項目**:
  - コメント（150字以内）

### FR-002: Twitter連携機能
- レビュー投稿後のTwitterシェア機能
- ツイート内容の自動生成

### FR-003: 詳細検索機能
- プレイ人数での絞り込み
- プレイ時間での絞り込み  
- タグでの絞り込み
- 各評価要素の得点範囲での絞り込み
- 複数条件での組み合わせ検索

### FR-004: レビュー表示機能
- ゲーム詳細ページでのレビュー一覧表示
- 各評価要素の平均点表示
- レビュー件数表示

### FR-005: ユーザー機能
#### 認証・ユーザー管理
- Google OAuth認証
- Twitter OAuth認証
- ユーザープロフィール管理
- ユーザー設定

#### ゲーム関連機能
- ゲーム検索・閲覧
- ゲーム詳細情報表示
- ゲーム一覧（カテゴリ別、人気順等）
- お気に入り機能

### FR-006: BGG API連携
- BGG APIからゲーム情報取得
- データ変換・正規化処理
- 定期的なデータ同期
- レート制限対応

---

## 🎨 UI/UX要件

### UX-001: 簡単操作 ⭐
- スライダーによる直感的な評価入力
- ボタン選択による簡単な属性選択
- 1ページ完結型フォーム
- 1-2分で完了できるフォーム設計
- プレビュー機能なし（即座に投稿完了）

### UX-002: レスポンシブ対応
- スマートフォンでの快適な操作
- タブレットでの見やすい表示
- タッチ操作に最適化されたスライダー

### UX-003: デザイン性
- モダンで洗練されたUI
- 直感的で美しいスライダーデザイン
- 一目で理解できる評価表示

---

## 🗄️ データ構造

### レビューテーブル (reviews)
```sql
CREATE TABLE reviews (
  id BIGSERIAL PRIMARY KEY,
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  game_id BIGINT REFERENCES games(id) ON DELETE CASCADE,
  
  -- 5つの評価要素
  overall_score DECIMAL(2,1) CHECK (overall_score >= 5.0 AND overall_score <= 10.0),
  complexity INTEGER CHECK (complexity >= 1 AND complexity <= 5),
  luck_factor INTEGER CHECK (luck_factor >= 1 AND luck_factor <= 5),
  interaction INTEGER CHECK (interaction >= 1 AND interaction <= 5),
  downtime INTEGER CHECK (downtime >= 1 AND downtime <= 5),
  
  -- 選択式項目
  recommended_players INTEGER[], -- [2,3,4] など
  tags TEXT[], -- ['戦略', '初心者向け'] など
  categories TEXT[], -- ['ユーロゲーム', 'エンジンビルド'] など
  
  -- 任意項目
  comment TEXT CHECK (LENGTH(comment) <= 150),
  
  -- メタデータ
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  
  -- 制約
  UNIQUE(user_id, game_id) -- 1ユーザー1ゲーム1レビュー
);
```

---

## 🏷️ タグ・カテゴリー定義

### おすすめプレイ人数
- 1人（ソロ）
- 2人
- 3人
- 4人
- 5人
- 6人以上

### タグ例
- 初心者向け
- 経験者向け
- 戦略重視
- 運要素強め
- 短時間
- じっくり
- 軽量級
- 重量級
- 協力
- 対戦
- パーティー

### カテゴリー例
- ユーロゲーム
- アメリカンゲーム
- エンジンビルド
- ワーカープレイスメント
- デッキビルド
- タイル配置
- エリア支配
- セットコレクション
- ドラフト
- 正体隠匿

---

## 🔍 検索機能詳細

### 検索フィルター
1. **プレイ人数**: チェックボックス選択
2. **プレイ時間**: 範囲スライダー (15-180分)
3. **タグ**: 複数選択チェックボックス
4. **評価要素範囲**:
   - 総合得点: 範囲スライダー (5-10)
   - 複雑さ: 範囲スライダー (1-5)
   - 運要素: 範囲スライダー (1-5)
   - インタラクション: 範囲スライダー (1-5)
   - ダウンタイム: 範囲スライダー (1-5)

### 並び替え
- 総合得点順
- レビュー件数順
- 新着順
- プレイ時間順

---

## 📱 Twitter連携仕様

### ツイート内容テンプレート
```
[ゲーム名] をレビューしました！

⭐総合: {overall_score}/10
🧩複雑さ: {complexity}/5  
🎲運要素: {luck_factor}/5
👥インタラクション: {interaction}/5
⏰ダウンタイム: {downtime}/5

おすすめ人数: {recommended_players}人
{comment}

#BGR #ボードゲーム #{game_name}
{review_url}
```

---

## 🚀 実装優先度

### Phase 1 (MVP) ⭐
1. レビュー投稿機能
2. レビュー表示機能
3. 基本検索機能

### Phase 2  
1. Twitter連携
2. 詳細検索フィルター
3. 並び替え機能

### Phase 3
1. レビュー統計表示
2. ユーザープロフィール強化
3. おすすめ機能

---

## 📊 実装状況

### ✅ 完了済み
- プロジェクト基盤セットアップ
- Supabase データベース設定
- OAuth認証システム (Twitter/Google)
- BGG API 連携機能
- ゲーム管理・検索機能
- 基本レビューシステム
- 管理パネル
- UI/UX デザイン実装
- ホームページ実装
- Netlify デプロイ設定

### 🔄 進行中
- レビューシステムv2実装
- モックアップ作成完了
- ドキュメント統合

### 📋 今後の予定
- 残りUIコンポーネント実装
- 単体テスト拡充
- パフォーマンス最適化

---

**最終更新**: 2025-08-22  
**重要**: 画像アップロード機能は**プロフィール画像のみ**に限定し、レビューには画像機能は実装しない

**関連ドキュメント**:
- `004_review_system_mockup.md`
- `mockups/review-form-wireframes.md`
- `mockups/review-form-visual-mockup.md`
- `mockups/twitter-share-mockup.md`